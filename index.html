<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Customizable Countdown Timer</title>
<style>
:root {
  --bg1: #0f1226;
  --bg2: #111827;
  --fg: #ffffff;
  --accent: #60a5fa;
  --accent2: #a78bfa;
  --card-bg: rgba(17,24,39,0.7);
  --unit-bg: rgba(2,6,23,0.5);
  --font-size: 16px;
  --unit-font-size: 22px;
  --label-font-size: 12px;
}
body {
  margin: 0;
  font-family: system-ui, sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  background: linear-gradient(160deg, var(--bg1), var(--bg2));
  color: var(--fg);
  text-align: center;
  font-size: var(--font-size);
}
.card {
  background: var(--card-bg);
  padding: 24px;
  border-radius: 20px;
  max-width: 90%;
  box-shadow: 0 4px 20px rgba(0,0,0,0.3);
  position: relative;
}
h1 {
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  -webkit-background-clip: text;
  color: transparent;
  font-size: 2.5em;
  margin-bottom: 16px;
}
.timer {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 12px;
}
.unit {
  min-width: 80px;
  padding: 12px;
  border-radius: 12px;
  background: var(--unit-bg);
  transition: transform 0.3s ease, background 0.3s ease;
}
.unit:hover {
  transform: scale(1.05);
}
.num {
  font-weight: 700;
  font-size: var(--unit-font-size);
}
.lab {
  font-size: var(--label-font-size);
  color: #ffffff;
}
.note {
  margin-bottom: 12px;
  font-style: italic;
}
.settings {
  margin-top: 20px;
  padding: 16px;
  background: rgba(255,255,255,0.1);
  border-radius: 12px;
  max-height: 300px;
  overflow-y: auto;
  display: none;
}
.settings h2 {
  font-size: 1.5em;
  margin-bottom: 12px;
  color: var(--fg);
}
.settings label {
  display: block;
  margin: 8px 0;
  font-size: 0.9em;
}
.settings input, .settings select, .settings button {
  margin: 4px;
  padding: 8px;
  border-radius: 8px;
  border: none;
  background: rgba(255,255,255,0.2);
  color: var(--fg);
  font-size: 0.9em;
}
.settings button {
  background: var(--accent);
  cursor: pointer;
  transition: background 0.3s ease;
}
.settings button:hover {
  background: var(--accent2);
}
.hidden {
  display: none;
}
#settings-toggle {
  position: fixed;
  top: 20px;
  right: 20px;
  padding: 10px;
  background: var(--accent);
  border-radius: 8px;
  cursor: pointer;
}
#break-section {
  margin-top: 20px;
  border-top: 1px solid var(--fg);
  padding-top: 10px;
}
.break-row {
  display: flex;
  justify-content: center;
  gap: 12px;
  margin-top: 12px;
}
.modal {
  display: none;
  position: fixed;
  z-index: 1;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0,0,0,0.4);
}
.modal-content {
  background-color: var(--card-bg);
  margin: 15% auto;
  padding: 20px;
  border: 1px solid #888;
  width: 80%;
  max-width: 400px;
  border-radius: 12px;
}
.close {
  color: var(--fg);
  float: right;
  font-size: 28px;
  font-weight: bold;
}
.close:hover,
.close:focus {
  color: var(--accent);
  text-decoration: none;
  cursor: pointer;
}
</style>
</head>
<body>
<div id="settings-toggle">⚙️ Settings</div>
<div class="card" id="timer-card">
  <h1 id="timer-title">Countdown Timer</h1>
  <div class="note" id="timer-note">Time only 6:30 to 19:30</div>

  <div class="timer" id="row1">
    <div class="unit" id="months-unit"><div class="num" id="months">--</div><div class="lab">Months</div></div>
    <div class="unit" id="days1-unit"><div class="num" id="days1">--</div><div class="lab">Days</div></div>
    <div class="unit" id="hours1-unit"><div class="num" id="hours1">--</div><div class="lab">Hours</div></div>
  </div>

  <div class="timer" id="row2">
    <div class="unit" id="days2-unit"><div class="num" id="days2">--</div><div class="lab">Days</div></div>
    <div class="unit" id="hours2-unit"><div class="num" id="hours2">--</div><div class="lab">Hours</div></div>
    <div class="unit" id="minutes2-unit"><div class="num" id="minutes2">--</div><div class="lab">Minutes</div></div>
    <div class="unit" id="seconds2-unit"><div class="num" id="seconds2">--</div><div class="lab">Seconds</div></div>
  </div>

  <div class="timer break-row hidden" id="break-row">
    <div class="unit" id="current-break-unit"><div class="num" id="current-break">--</div><div class="lab">Current Break (min)</div></div>
    <div class="unit" id="total-break-unit"><div class="num" id="total-break">--</div><div class="lab">Total Break (min)</div></div>
  </div>

  <div class="settings" id="settings-panel">
    <h2>Customize Timer</h2>
    <label>Target Date and Time: <input type="datetime-local" id="target-datetime" placeholder="mm/dd/yyyy --:-- --"></label>
    <label>Start Hour (0-24): <input type="number" id="start-hour" min="0" max="24" step="0.5" value="6.5"></label>
    <label>End Hour (0-24): <input type="number" id="end-hour" min="0" max="24" step="0.5" value="19.5"></label>
    <label>Timer Title: <input type="text" id="timer-title-input" placeholder="Countdown Timer"></label>
    <label>Note: <input type="text" id="timer-note-input" placeholder="Time only 6:30 to 19:30"></label>
    <label>Background Color 1: <input type="color" id="bg1" value="#0f1226"></label>
    <label>Background Color 2: <input type="color" id="bg2" value="#111827"></label>
    <label>Text Color: <input type="color" id="fg" value="#e5e7eb"></label>
    <label>Accent Color 1: <input type="color" id="accent" value="#60a5fa"></label>
    <label>Accent Color 2: <input type="color" id="accent2" value="#a78bfa"></label>
    <label>Card Opacity (0-1): <input type="number" id="card-opacity" min="0" max="1" step="0.1" value="0.7"></label>
    <label>Unit Opacity (0-1): <input type="number" id="unit-opacity" min="0" max="1" step="0.1" value="0.5"></label>
    <label>Font Size (px): <input type="number" id="font-size" min="10" max="30" value="16"></label>
    <label>Unit Font Size (px): <input type="number" id="unit-font-size" min="12" max="40" value="22"></label>
    <label>Label Font Size (px): <input type="number" id="label-font-size" min="8" max="20" value="12"></label>
    <label>Background Gradient Angle: <input type="number" id="gradient-angle" min="0" max="360" value="160"></label>
    <label>Card Border Radius (px): <input type="number" id="card-border-radius" min="0" max="50" value="20"></label>
    <label>Unit Border Radius (px): <input type="number" id="unit-border-radius" min="0" max="50" value="12"></label>
    <label>Card Padding (px): <input type="number" id="card-padding" min="10" max="50" value="24"></label>
    <label>Unit Padding (px): <input type="number" id="unit-padding" min="5" max="30" value="12"></label>
    <label>Gap Between Units (px): <input type="number" id="unit-gap" min="5" max="30" value="12"></label>
    <label>Font Family: 
      <select id="font-family">
        <option value="system-ui, sans-serif">System UI</option>
        <option value="Arial, sans-serif">Arial</option>
        <option value="Georgia, serif">Georgia</option>
        <option value="Courier New, monospace">Courier New</option>
      </select>
    </label>
    <label>Animation Speed (s): <input type="number" id="animation-speed" min="0.1" max="2" step="0.1" value="0.3"></label>
    <label>Show Seconds: <input type="checkbox" id="show-seconds" checked></label>
    <label>Dark Mode: <input type="checkbox" id="dark-mode" checked></label>
    <label>Timer Alignment: 
      <select id="timer-alignment">
        <option value="center">Center</option>
        <option value="flex-start">Left</option>
        <option value="flex-end">Right</option>
      </select>
    </label>
    <button id="save-settings-btn">Save Settings</button>
    <button onclick="resetSettings()">Reset to Default</button>
    <button id="customize-units-btn">Customize Visible Units</button>
    <button onclick="exportTodayData()">Export Today Data</button>
    <div id="break-section">
      <h3>Break/Pause</h3>
      <label>Break Duration (minutes): <input type="number" id="break-minutes" min="1" value="5"></label>
      <button onclick="startBreak()">Start Break</button>
    </div>
  </div>

  <!-- Units Customization Modal -->
  <div id="units-modal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <h2>Customize Visible Units</h2>
      <label><input type="checkbox" id="show-months" checked> Show Months</label>
      <label><input type="checkbox" id="show-days1" checked> Show Total Days</label>
      <label><input type="checkbox" id="show-hours1" checked> Show Total Active Hours</label>
      <label><input type="checkbox" id="show-days2" checked> Show Days in Month</label>
      <label><input type="checkbox" id="show-hours2" checked> Show Active Hours Today</label>
      <label><input type="checkbox" id="show-minutes2" checked> Show Minutes</label>
      <label><input type="checkbox" id="show-seconds2" checked> Show Seconds</label>
      <label><input type="checkbox" id="show-current-break" checked> Show Current Break</label>
      <label><input type="checkbox" id="show-total-break" checked> Show Total Break</label>
    </div>
  </div>

<script>
let TARGET = new Date(localStorage.getItem("targetDate") || "2025-12-31T19:30:00");
let START_H = parseFloat(localStorage.getItem("startHour") || 6.5);
let END_H = parseFloat(localStorage.getItem("endHour") || 19.5);
let ACTIVE_HOURS = END_H - START_H;
let timerInterval = setInterval(updateTimer, 1000);
let breakInterval = null;
let breakEndTime = null;
let totalBreakTime = parseInt(localStorage.getItem("totalBreakTime") || 0); // Track total break time in minutes
let currentBreakStart = null;

function pad(n) {
  return String(Math.floor(n)).padStart(2, '0');
}

function applyStyles() {
  const root = document.documentElement;
  root.style.setProperty('--bg1', localStorage.getItem('bg1') || '#0f1226');
  root.style.setProperty('--bg2', localStorage.getItem('bg2') || '#111827');
  root.style.setProperty('--fg', localStorage.getItem('fg') || '#e5e7eb');
  root.style.setProperty('--accent', localStorage.getItem('accent') || '#60a5fa');
  root.style.setProperty('--accent2', localStorage.getItem('accent2') || '#a78bfa');
  root.style.setProperty('--card-bg', `rgba(17,24,39,${localStorage.getItem('cardOpacity') || 0.7})`);
  root.style.setProperty('--unit-bg', `rgba(2,6,23,${localStorage.getItem('unitOpacity') || 0.5})`);
  root.style.setProperty('--font-size', `${localStorage.getItem('fontSize') || 16}px`);
  root.style.setProperty('--unit-font-size', `${localStorage.getItem('unitFontSize') || 22}px`);
  root.style.setProperty('--label-font-size', `${localStorage.getItem('labelFontSize') || 12}px`);
  document.body.style.background = `linear-gradient(${localStorage.getItem('gradientAngle') || 160}deg, var(--bg1), var(--bg2))`;
  document.querySelector('.card').style.borderRadius = `${localStorage.getItem('cardBorderRadius') || 20}px`;
  document.querySelectorAll('.unit').forEach(unit => {
    unit.style.borderRadius = `${localStorage.getItem('unitBorderRadius') || 12}px`;
    unit.style.padding = `${localStorage.getItem('unitPadding') || 12}px`;
  });
  document.querySelectorAll('.timer').forEach(timer => {
    timer.style.gap = `${localStorage.getItem('unitGap') || 12}px`;
    timer.style.justifyContent = localStorage.getItem('timerAlignment') || 'center';
  });
  document.querySelector('.card').style.padding = `${localStorage.getItem('cardPadding') || 24}px`;
  document.body.style.fontFamily = localStorage.getItem('fontFamily') || 'system-ui, sans-serif';
  document.querySelectorAll('.unit').forEach(unit => {
    unit.style.transition = `transform ${localStorage.getItem('animationSpeed') || 0.3}s ease, background ${localStorage.getItem('animationSpeed') || 0.3}s ease`;
  });
  document.getElementById('timer-title').textContent = localStorage.getItem('timerTitle') || 'Countdown Timer';
  document.getElementById('timer-note').textContent = localStorage.getItem('timerNote') || 'Time only 6:30 to 19:30';
  if (localStorage.getItem('darkMode') === 'false') {
    root.style.setProperty('--bg1', '#f3f4f6');
    root.style.setProperty('--bg2', '#e5e7eb');
    root.style.setProperty('--fg', '#1f2937');
    root.style.setProperty('--card-bg', 'rgba(255,255,255,0.8)');
    root.style.setProperty('--unit-bg', 'rgba(243,244,246,0.6)');
  }
  applyUnitVisibility();
  document.getElementById('total-break').textContent = pad(totalBreakTime);
}

function applyUnitVisibility() {
  document.getElementById('months-unit').style.display = localStorage.getItem('showMonths') === 'false' ? 'none' : 'block';
  document.getElementById('days1-unit').style.display = localStorage.getItem('showDays1') === 'false' ? 'none' : 'block';
  document.getElementById('hours1-unit').style.display = localStorage.getItem('showHours1') === 'false' ? 'none' : 'block';
  document.getElementById('days2-unit').style.display = localStorage.getItem('showDays2') === 'false' ? 'none' : 'block';
  document.getElementById('hours2-unit').style.display = localStorage.getItem('showHours2') === 'false' ? 'none' : 'block';
  document.getElementById('minutes2-unit').style.display = localStorage.getItem('showMinutes2') === 'false' ? 'none' : 'block';
  document.getElementById('seconds2-unit').style.display = localStorage.getItem('showSeconds2') === 'false' ? 'none' : 'block';
  document.getElementById('current-break-unit').style.display = localStorage.getItem('showCurrentBreak') === 'false' ? 'none' : 'block';
  document.getElementById('total-break-unit').style.display = localStorage.getItem('showTotalBreak') === 'false' ? 'none' : 'block';
}

function updateTimer() {
  if (breakInterval) {
    const now = new Date();
    let diffMs = breakEndTime - now;
    if (diffMs <= 0) {
      clearInterval(breakInterval);
      document.getElementById('break-row').classList.add('hidden');
      breakInterval = null;
      const breakDuration = Math.round((breakEndTime - (now - diffMs)) / 60000);
      totalBreakTime += breakDuration;
      localStorage.setItem("totalBreakTime", totalBreakTime);
      document.getElementById('total-break').textContent = pad(totalBreakTime);
      document.getElementById('current-break').textContent = '00';
      timerInterval = setInterval(updateTimer, 1000);
    } else {
     let minutes = Math.floor(diffMs / 60000);
let seconds = Math.floor((diffMs % 60000) / 1000);
document.getElementById('current-break').textContent = `${pad(minutes)}:${pad(seconds)}`;

    }
  }

  const now = new Date();
  const nowH = now.getHours() + now.getMinutes() / 60;

  let monthsLeft = TARGET.getMonth() - now.getMonth() + (TARGET.getFullYear() - now.getFullYear()) * 12;
  if (monthsLeft < 0) monthsLeft = 0;
  document.getElementById('months').textContent = pad(monthsLeft);

  let totalDays = Math.floor((TARGET - now) / (1000 * 60 * 60 * 24));
  let activeHoursToday = Math.max(0, Math.min(END_H, nowH) - START_H);
  let hoursLeft = totalDays * ACTIVE_HOURS - activeHoursToday;
  document.getElementById('days1').textContent = pad(totalDays);
  document.getElementById('hours1').textContent = pad(Math.floor(hoursLeft));

  const lastDayOfMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0);
  let daysLeftInMonth = lastDayOfMonth.getDate() - now.getDate();

  let startToday = new Date(now.getFullYear(), now.getMonth(), now.getDate(), Math.floor(START_H), (START_H % 1) * 60, 0);
  let endToday = new Date(now.getFullYear(), now.getMonth(), now.getDate(), Math.floor(END_H), (END_H % 1) * 60, 0);

  let hours2 = 0, mins2 = 0, secs2 = 0;
  if (now < startToday) {
    hours2 = ACTIVE_HOURS;
    mins2 = 0;
    secs2 = 0;
  } else if (now > endToday) {
    hours2 = mins2 = secs2 = 0;
  } else {
    let diffMs = endToday - now;
    hours2 = Math.floor(diffMs / 1000 / 3600);
    mins2 = Math.floor((diffMs / 1000 / 60) % 60);
    secs2 = Math.floor((diffMs / 1000) % 60);
  }

  document.getElementById('days2').textContent = pad(daysLeftInMonth);
  document.getElementById('hours2').textContent = pad(hours2);
  document.getElementById('minutes2').textContent = pad(mins2);
  document.getElementById('seconds2').textContent = pad(secs2);
}

function startBreak() {
  if (!breakInterval) {
    const breakMinutes = parseInt(document.getElementById('break-minutes').value) || 5;
    clearInterval(timerInterval);
    currentBreakStart = new Date();
    breakEndTime = new Date(Date.now() + breakMinutes * 60 * 1000);
    document.getElementById('break-row').classList.remove('hidden');
    breakInterval = setInterval(updateTimer, 1000);
  }
}

function resetSettings() {
  localStorage.clear();
  TARGET = new Date("2025-12-31T19:30:00");
  START_H = 6.5;
  END_H = 19.5;
  ACTIVE_HOURS = END_H - START_H;
  totalBreakTime = 0;
  document.getElementById('total-break').textContent = pad(totalBreakTime);
  document.getElementById('current-break').textContent = '00';
  document.getElementById('break-row').classList.add('hidden');
  document.getElementById('target-datetime').value = '';
  document.getElementById('start-hour').value = 6.5;
  document.getElementById('end-hour').value = 19.5;
  document.getElementById('timer-title-input').value = 'Countdown Timer';
  document.getElementById('timer-note-input').value = 'Time only 6:30 to 19:30';
  document.getElementById('bg1').value = '#0f1226';
  document.getElementById('bg2').value = '#111827';
  document.getElementById('fg').value = '#e5e7eb';
  document.getElementById('accent').value = '#60a5fa';
  document.getElementById('accent2').value = '#a78bfa';
  document.getElementById('card-opacity').value = 0.7;
  document.getElementById('unit-opacity').value = 0.5;
  document.getElementById('font-size').value = 16;
  document.getElementById('unit-font-size').value = 22;
  document.getElementById('label-font-size').value = 12;
  document.getElementById('gradient-angle').value = 160;
  document.getElementById('card-border-radius').value = 20;
  document.getElementById('unit-border-radius').value = 12;
  document.getElementById('card-padding').value = 24;
  document.getElementById('unit-padding').value = 12;
  document.getElementById('unit-gap').value = 12;
  document.getElementById('font-family').value = 'system-ui, sans-serif';
  document.getElementById('animation-speed').value = 0.3;
  document.getElementById('show-seconds').checked = true;
  document.getElementById('dark-mode').checked = true;
  document.getElementById('timer-alignment').value = 'center';
  document.getElementById('show-months').checked = true;
  document.getElementById('show-days1').checked = true;
  document.getElementById('show-hours1').checked = true;
  document.getElementById('show-days2').checked = true;
  document.getElementById('show-hours2').checked = true;
  document.getElementById('show-minutes2').checked = true;
  document.getElementById('show-seconds2').checked = true;
  document.getElementById('show-current-break').checked = true;
  document.getElementById('show-total-break').checked = true;
  applyAllSettings();
  updateTimer();
}

function applyAllSettings() {
  const targetDate = document.getElementById('target-datetime').value;
  if (targetDate) {
    TARGET = new Date(targetDate);
    localStorage.setItem('targetDate', TARGET.toISOString());
  }
  START_H = parseFloat(document.getElementById('start-hour').value);
  END_H = parseFloat(document.getElementById('end-hour').value);
  ACTIVE_HOURS = END_H - START_H;
  localStorage.setItem('startHour', START_H);
  localStorage.setItem('endHour', END_H);
  localStorage.setItem('timerTitle', document.getElementById('timer-title-input').value);
  localStorage.setItem('timerNote', document.getElementById('timer-note-input').value);
  localStorage.setItem('bg1', document.getElementById('bg1').value);
  localStorage.setItem('bg2', document.getElementById('bg2').value);
  localStorage.setItem('fg', document.getElementById('fg').value);
  localStorage.setItem('accent', document.getElementById('accent').value);
  localStorage.setItem('accent2', document.getElementById('accent2').value);
  localStorage.setItem('cardOpacity', document.getElementById('card-opacity').value);
  localStorage.setItem('unitOpacity', document.getElementById('unit-opacity').value);
  localStorage.setItem('fontSize', document.getElementById('font-size').value);
  localStorage.setItem('unitFontSize', document.getElementById('unit-font-size').value);
  localStorage.setItem('labelFontSize', document.getElementById('label-font-size').value);
  localStorage.setItem('gradientAngle', document.getElementById('gradient-angle').value);
  localStorage.setItem('cardBorderRadius', document.getElementById('card-border-radius').value);
  localStorage.setItem('unitBorderRadius', document.getElementById('unit-border-radius').value);
  localStorage.setItem('cardPadding', document.getElementById('card-padding').value);
  localStorage.setItem('unitPadding', document.getElementById('unit-padding').value);
  localStorage.setItem('unitGap', document.getElementById('unit-gap').value);
  localStorage.setItem('fontFamily', document.getElementById('font-family').value);
  localStorage.setItem('animationSpeed', document.getElementById('animation-speed').value);
  localStorage.setItem('showSeconds', document.getElementById('show-seconds').checked);
  localStorage.setItem('darkMode', document.getElementById('dark-mode').checked);
  localStorage.setItem('timerAlignment', document.getElementById('timer-alignment').value);
  document.getElementById('settings-panel').style.display = 'none';
  applyStyles();
  updateTimer();
}

// Live update event listeners
document.querySelectorAll('.settings input, .settings select').forEach(input => {
  input.addEventListener('input', applyAllSettings);
});

// Draggable card
let isDragging = false;
let startX, startY, initialLeft, initialTop;

document.getElementById('timer-card').addEventListener('mousedown', (e) => {
  if (e.target.closest('.settings')) return;
  isDragging = true;
  startX = e.clientX;
  startY = e.clientY;
  initialLeft = parseInt(getComputedStyle(document.getElementById('timer-card')).left) || 0;
  initialTop = parseInt(getComputedStyle(document.getElementById('timer-card')).top) || 0;
  document.body.style.cursor = 'grabbing';
  document.getElementById('settings-panel').style.display = 'none';
});

document.addEventListener('mousemove', (e) => {
  if (isDragging) {
    const dx = e.clientX - startX;
    const dy = e.clientY - startY;
    document.getElementById('timer-card').style.position = 'absolute';
    document.getElementById('timer-card').style.left = `${initialLeft + dx}px`;
    document.getElementById('timer-card').style.top = `${initialTop + dy}px`;
  }
});

document.addEventListener('mouseup', () => {
  isDragging = false;
  document.body.style.cursor = 'default';
});

// Toggle settings
document.getElementById('settings-toggle').addEventListener('click', () => {
  const panel = document.getElementById('settings-panel');
  panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
});

// Units modal
document.getElementById('customize-units-btn').addEventListener('click', () => {
  document.getElementById('units-modal').style.display = 'block';
});

function closeModal() {
  document.getElementById('units-modal').style.display = 'none';
}

// Load unit visibility checkboxes
document.getElementById('show-months').checked = localStorage.getItem('showMonths') !== 'false';
document.getElementById('show-days1').checked = localStorage.getItem('showDays1') !== 'false';
document.getElementById('show-hours1').checked = localStorage.getItem('showHours1') !== 'false';
document.getElementById('show-days2').checked = localStorage.getItem('showDays2') !== 'false';
document.getElementById('show-hours2').checked = localStorage.getItem('showHours2') !== 'false';
document.getElementById('show-minutes2').checked = localStorage.getItem('showMinutes2') !== 'false';
document.getElementById('show-seconds2').checked = localStorage.getItem('showSeconds2') !== 'false';
document.getElementById('show-current-break').checked = localStorage.getItem('showCurrentBreak') !== 'false';
document.getElementById('show-total-break').checked = localStorage.getItem('showTotalBreak') !== 'false';

// Live update for units
document.querySelectorAll('#units-modal input[type="checkbox"]').forEach(checkbox => {
  checkbox.addEventListener('change', () => {
    localStorage.setItem('showMonths', document.getElementById('show-months').checked);
    localStorage.setItem('showDays1', document.getElementById('show-days1').checked);
    localStorage.setItem('showHours1', document.getElementById('show-hours1').checked);
    localStorage.setItem('showDays2', document.getElementById('show-days2').checked);
    localStorage.setItem('showHours2', document.getElementById('show-hours2').checked);
    localStorage.setItem('showMinutes2', document.getElementById('show-minutes2').checked);
    localStorage.setItem('showSeconds2', document.getElementById('show-seconds2').checked);
    localStorage.setItem('showCurrentBreak', document.getElementById('show-current-break').checked);
    localStorage.setItem('showTotalBreak', document.getElementById('show-total-break').checked);
    applyUnitVisibility();
  });
});

// Load current values into inputs
if (localStorage.getItem('targetDate')) {
  document.getElementById('target-datetime').value = new Date(localStorage.getItem('targetDate')).toISOString().slice(0,16);
}
document.getElementById('start-hour').value = START_H;
document.getElementById('end-hour').value = END_H;
document.getElementById('timer-title-input').value = localStorage.getItem('timerTitle') || 'Countdown Timer';
document.getElementById('timer-note-input').value = localStorage.getItem('timerNote') || 'Time only 6:30 to 19:30';
document.getElementById('bg1').value = localStorage.getItem('bg1') || '#0f1226';
document.getElementById('bg2').value = localStorage.getItem('bg2') || '#111827';
document.getElementById('fg').value = localStorage.getItem('fg') || '#e5e7eb';
document.getElementById('accent').value = localStorage.getItem('accent') || '#60a5fa';
document.getElementById('accent2').value = localStorage.getItem('accent2') || '#a78bfa';
document.getElementById('card-opacity').value = localStorage.getItem('cardOpacity') || 0.7;
document.getElementById('unit-opacity').value = localStorage.getItem('unitOpacity') || 0.5;
document.getElementById('font-size').value = localStorage.getItem('fontSize') || 16;
document.getElementById('unit-font-size').value = localStorage.getItem('unitFontSize') || 22;
document.getElementById('label-font-size').value = localStorage.getItem('labelFontSize') || 12;
document.getElementById('gradient-angle').value = localStorage.getItem('gradientAngle') || 160;
document.getElementById('card-border-radius').value = localStorage.getItem('cardBorderRadius') || 20;
document.getElementById('unit-border-radius').value = localStorage.getItem('unitBorderRadius') || 12;
document.getElementById('card-padding').value = localStorage.getItem('cardPadding') || 24;
document.getElementById('unit-padding').value = localStorage.getItem('unitPadding') || 12;
document.getElementById('unit-gap').value = localStorage.getItem('unitGap') || 12;
document.getElementById('font-family').value = localStorage.getItem('fontFamily') || 'system-ui, sans-serif';
document.getElementById('animation-speed').value = localStorage.getItem('animationSpeed') || 0.3;
document.getElementById('show-seconds').checked = localStorage.getItem('showSeconds') !== 'false';
document.getElementById('dark-mode').checked = localStorage.getItem('darkMode') !== 'false';
document.getElementById('timer-alignment').value = localStorage.getItem('timerAlignment') || 'center';

function exportTodayData() {
  const now = new Date();
  const today = now.toISOString().split('T')[0];
  const todayData = `Today (${today}): Total Break Time = ${totalBreakTime} minutes`;
  const blob = new Blob([todayData], { type: 'text/plain' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = `timer_data_${today}.txt`;
  a.click();
}

applyStyles();
updateTimer();
</script>
</body>
</html>